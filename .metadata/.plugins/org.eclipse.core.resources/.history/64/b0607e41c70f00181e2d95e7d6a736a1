
public class Solution7 {
	public static void main(String[] args){
		Solution7 s = new Solution7();
		String input = "(()()(()";
		System.out.println(s.longestValidParentheses(input));
	}
	
	  public int longestValidParentheses(String s) {
		    char[] S = s.toCharArray();
		    int[] V = new int[S.length];
		    int open = 0;
		    int max = 0;
		    for (int i=0; i<S.length; i++) {
		        if (S[i] == '(') open++;
		        if (S[i] == ')' && open > 0) {
		            // matches found
		            V[i] = 2+ V[i-1];
		            // add matches from previous
		            if(i-V[i]>0)
		                V[i] += V[i-V[i]];
		            open--;
		        }
		        if (V[i] > max) max = V[i];
		    }
		    return max;
	  }
}
